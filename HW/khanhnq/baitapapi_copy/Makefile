.PHONY: install remove start zip

VENV_DIR := .venv
PYTHON := /opt/anaconda3/envs/py311/bin/python 
ARCHIVE := archive.zip


install:
	@echo "ğŸ”§ Creating virtual environment..."
	@$(PYTHON) -m venv $(VENV_DIR)
	@echo "âœ… Virtual environment created."

	@echo "ğŸ“¦ Installing Poetry..."
	@. $(VENV_DIR)/bin/activate && pip install poetry
	@echo "âœ… Poetry installed."

	@echo "ğŸ“š Installing dependencies with Poetry..."
	@. $(VENV_DIR)/bin/activate && poetry install --no-root
	@echo "âœ… Dependencies installed."

	@echo "ğŸ§¹ Setting up pre-commit hooks..."
	@. $(VENV_DIR)/bin/activate && pre-commit install
	@echo "âœ… Pre-commit hooks installed."

remove:
	@echo "ğŸ—‘ï¸  Removing virtual environment..."
	@rm -rf $(VENV_DIR)
	@echo "âœ… Virtual environment removed."

start:
	@echo "ğŸš€ Starting application..."
	$(VENV_DIR)/bin/python $(PWD)/app/main.py
	@echo "âœ… Application exited."

zip:
	@echo "ğŸ“¦ Zipping all folders and files (excluding $(VENV_DIR) folder)..."
	@zip -r $(ARCHIVE) . -x "$(VENV_DIR)/*" -x ".mypy_cache/*" -x "$(ARCHIVE)"
	@echo "âœ… Archive '$(ARCHIVE)' created."